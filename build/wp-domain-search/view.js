document.addEventListener("DOMContentLoaded",(()=>{document.querySelectorAll(".wp-block-create-block-wp-domain-search").forEach((e=>{const t=e.querySelector(".wp-domain-search-input"),n=e.querySelector(".wp-domain-search-button"),a=e.querySelectorAll(".wp-domain-search-tld"),r=e.querySelector(".wp-domain-search-results"),o=e.querySelector(".wp-domain-search-loading"),s=e.querySelector(".wp-domain-search-error"),c=e.getAttribute("data-nonce");function i(){if(!t.value.trim())return void d("Παρακαλούμε εισάγετε ένα όνομα domain.");const e=Array.from(a).filter((e=>e.checked)).map((e=>e.value));if(0===e.length)return void d("Παρακαλούμε επιλέξτε τουλάχιστον ένα TLD.");r.innerHTML="",s.textContent="",s.classList.remove("active");let n=t.value.trim();e.forEach((e=>{const t=`.${e}`;n.endsWith(t)&&(n=n.slice(0,-t.length))})),o.classList.add("active");const i=new FormData;i.append("action","wp_domain_search"),i.append("nonce",c),i.append("domain",n),i.append("tlds",JSON.stringify(e)),fetch(wpDomainSearch.ajaxUrl,{method:"POST",credentials:"same-origin",body:i}).then((e=>{if(!e.ok)throw new Error("Network response was not ok");return e.json()})).then((e=>{o.classList.remove("active"),!1!==e.success?function(e){if(!e||0===Object.keys(e).length)return void d("Δεν βρέθηκαν αποτελέσματα.");const t=Object.entries(e).map((([e,t])=>(console.log(e,t,typeof t),`\n                    <div class="wp-domain-search-result-item">\n                        <strong>${e}</strong>: <span class="${"1"===t||1===t?"wp-domain-search-result-available":"wp-domain-search-result-unavailable"}">${"1"===t||1===t?"Διαθέσιμο":"Μη διαθέσιμο"}</span>\n                    </div>\n                `))).join("");r.innerHTML=t}(e.data):d(e.data||"Υπήρξε ένα σφάλμα κατά την αναζήτηση.")})).catch((e=>{o.classList.remove("active"),d("Υπήρξε ένα σφάλμα κατά την αναζήτηση: "+e.message)}))}function d(e){s.textContent=e,s.classList.add("active")}n.addEventListener("click",(()=>{i()})),t.addEventListener("keypress",(e=>{"Enter"===e.key&&(e.preventDefault(),i())}))}))}));