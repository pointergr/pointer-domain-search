document.addEventListener("DOMContentLoaded",(()=>{document.querySelectorAll(".wp-block-create-block-pointer-domain-search").forEach((e=>{const t=e.querySelector(".pointer-domain-search-input"),n=e.querySelector(".pointer-domain-search-button"),r=e.querySelectorAll(".pointer-domain-search-tld"),a=e.querySelector(".pointer-domain-search-results"),o=e.querySelector(".pointer-domain-search-loading"),i=e.querySelector(".pointer-domain-search-error"),s=e.getAttribute("data-nonce");function c(){if(!t.value.trim())return void d("Παρακαλούμε εισάγετε ένα όνομα domain.");const e=Array.from(r).filter((e=>e.checked)).map((e=>e.value));if(0===e.length)return void d("Παρακαλούμε επιλέξτε τουλάχιστον ένα TLD.");a.innerHTML="",i.textContent="",i.classList.remove("active");let n=t.value.trim();e.forEach((e=>{const t=`.${e}`;n.endsWith(t)&&(n=n.slice(0,-t.length))})),o.classList.add("active");const c=new FormData;c.append("action","pointer_domain_search"),c.append("nonce",s),c.append("domain",n),c.append("tlds",JSON.stringify(e)),fetch(wpDomainSearch.ajaxUrl,{method:"POST",credentials:"same-origin",body:c}).then((e=>{if(!e.ok)throw new Error("Network response was not ok");return e.json()})).then((e=>{o.classList.remove("active"),!1!==e.success?function(e){if(!e||0===Object.keys(e).length)return void d("Δεν βρέθηκαν αποτελέσματα.");const t=Object.entries(e).map((([e,t])=>`\n                    <div class="pointer-domain-search-result-item">\n                        <strong>${e}</strong>: <span class="${"1"===t||1===t?"pointer-domain-search-result-available":"pointer-domain-search-result-unavailable"}">${"1"===t||1===t?"Διαθέσιμο":"Μη διαθέσιμο"}</span>\n                    </div>\n                `)).join("");a.innerHTML=t}(e.data):d(e.data||"Υπήρξε ένα σφάλμα κατά την αναζήτηση.")})).catch((e=>{o.classList.remove("active"),d("Υπήρξε ένα σφάλμα κατά την αναζήτηση: "+e.message)}))}function d(e){i.textContent=e,i.classList.add("active")}n.addEventListener("click",(()=>{c()})),t.addEventListener("keypress",(e=>{"Enter"===e.key&&(e.preventDefault(),c())}))}))}));